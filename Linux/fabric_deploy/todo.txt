============= check for unauthorized sudo =======
sudo	NOPASSWD:	/etc/sudoers
doas	nopass	/etc/doas.conf
run0	polkit.Result.YES	/etc/polkit-1/rules.d/*.rules
pkexec	polkit.Result.YES	/etc/polkit-1/rules.d/*.rules
su	Not natively supported*	Built-in (standard behavior requires password)

====== small tasks ===
fix time    sudo timedatectl set-ntp true
check internet works (ping 1.1.1.1)
check dns works (resolve example.com)
check locale settings (language, time)
review boot logs
check mounts and fstabs
Validate repo URLs, mirrorlists, proxies, and TLS CA bundles (bad CA store breaks everything).
check ulimit to make sure they are sane
check mail for root Mail spool

------- related commands ----------
uptime, w, last reboot
df -h, df -ih
free -h (or vmstat 1 5)
dmesg -T | tail -200 (or journalctl -p warning..alert -b)
ps aux --sort=-%mem | head, ps aux --sort=-%cpu | head
ss -tulpn (or netstat -tulpn)
systemctl --failed (if systemd)
crontab -l + check cron service / timers
Disk health: smartctl -H / nvme smart-log (if tools installed)

====== important =====
add init system discovery to discovery
fix sshd restart based on init system
    /etc/rc.d/rc.sshd restart   <- slackware
    rc-service sshd restart     <- rc based systems

==== simplification ===
replace setup agent module with an extention to the users module    (might want to add a ssh key to the root and hardening user)


==== improve ====
lockdown.sh
    update lockdown to allow any port from trusted ips

ssh_hardening.py
    improve recovery from bad ssh configs, instead of relying on current ssh connection to run commands to revert the change, run a command like this:
    nohup:
        print pid
        sleep(60)
        revert command
        restart sshd
    capture the pid an on connection test success kill pid

user_hardening.py
    have user hardening implant ssh keys for users
