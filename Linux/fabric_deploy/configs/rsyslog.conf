# CCDC Enhanced Logging Configuration
$ModLoad imuxsock # provides support for local system logging
$ModLoad imklog   # provides kernel logging support

# Enhanced logging rules
*.info;mail.none;authpriv.none;cron.none    /var/log/messages
authpriv.*                                  /var/log/secure
mail.*                                      /var/log/maillog
cron.*                                      /var/log/cron
*.emerg                                     :omusrmsg:*
uucp,news.crit                              /var/log/spooler
local7.*                                    /var/log/boot.log

# Security-focused logging
auth,authpriv.*                             /var/log/auth.log
kern.*                                      /var/log/kern.log
daemon.*                                    /var/log/daemon.log
syslog.*                                    /var/log/syslog

# Log failed login attempts
auth.info                                   /var/log/auth.log
authpriv.warning                            /var/log/secure

# Log all SSH connections
if $programname == 'sshd' then /var/log/ssh.log
& stop

# Log sudo usage
if $programname == 'sudo' then /var/log/sudo.log
& stop

# Forward critical messages to console
*.crit                                      /dev/console

# Include additional config files
$IncludeConfig /etc/rsyslog.d/*.conf
