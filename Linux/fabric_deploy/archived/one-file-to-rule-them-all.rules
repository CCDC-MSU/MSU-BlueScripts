## Auditd Rules - CCDC Competition Ready
## =========================================
## 
## Key Naming Convention:
##   - Lowercase with underscores
##   - Format: category_description
##   - Examples: privesc_root_cmd, persist_cron, c2_netcat
##
## Categories:
##   recon_*      - Reconnaissance/Discovery
##   exec_*       - Execution
##   persist_*    - Persistence  
##   privesc_*    - Privilege Escalation
##   defense_*    - Defense Evasion
##   cred_*       - Credential Access
##   discover_*   - Discovery
##   c2_*         - Command & Control
##   exfil_*      - Exfiltration
##   impact_*     - Impact
##   net_*        - Network activity
##   kernel_*     - Kernel operations
##   container_*  - Container operations
##   file_*       - File operations
##   ccdc_*       - CCDC-specific high-priority alerts
##
## Usage:
##   ausearch -k privesc_root_cmd
##   aureport -k --summary
##


## ============================================================
## Configuration
## Buffer size for audit backlog
## ============================================================

-b 8192

## ============================================================
## Exclusions
## Reduce noise by excluding high-volume low-value events
## ============================================================

-a always,exclude -F msgtype=AVC
-a always,exclude -F msgtype=CRYPTO_KEY_USER
-a always,exclude -F msgtype=CWD
-a exit,never -F arch=b64 -S all -F exe=/usr/bin/vmtoolsd
-a never,exit -F arch=b32 -F dir=/dev/shm -k sharedmemaccess
-a never,exit -F arch=b32 -F dir=/var/lock/lvm -k locklvm
-a never,exit -F arch=b32 -F path=/opt/filebeat -k filebeat
-a never,exit -F arch=b32 -S adjtimex -F auid=unset -F uid=chrony -F subj_type=chronyd_t
-a never,exit -F arch=b32 -S fork -F success=0 -F path=/usr/lib/vmware-tools -F subj_type=initrc_t -F exit=-2
-a never,exit -F arch=b64 -F dir=/dev/shm -k sharedmemaccess
-a never,exit -F arch=b64 -F dir=/var/lock/lvm -k locklvm
-a never,exit -F arch=b64 -S fork -F success=0 -F path=/usr/lib/vmware-tools -F subj_type=initrc_t -F exit=-2
-a never,exit -F subj_type=crond_t
-a never,filesystem -F fstype=debugfs
-a never,filesystem -F fstype=tracefs
-a never,user -F subj_type=crond_t

## ============================================================
## Webshell Detection
## Detect command execution by web server users (www-data, apache, nginx)
## ============================================================

-a always,exit -F arch=b32 -F euid=33 -S execve -k ccdc_web_exec
-a always,exit -F arch=b32 -F euid=48 -S execve -k ccdc_web_exec
-a always,exit -F arch=b32 -F euid=987 -S execve -k ccdc_web_exec
-a always,exit -F arch=b64 -F euid=33 -S execve -k ccdc_web_exec
-a always,exit -F arch=b64 -F euid=48 -S execve -k ccdc_web_exec
-a always,exit -F arch=b64 -F euid=987 -S execve -k ccdc_web_exec

## ============================================================
## Privilege Escalation
## Monitor commands run as root by non-root users
## ============================================================

-a always,exit -F arch=b32 -F euid=0 -F auid>=1000 -F auid!=-1 -S execve -k privesc_root_cmd
-a always,exit -F arch=b32 -F euid=0 -S execve -k privesc_root_cmd
-a always,exit -F arch=b64 -F euid=0 -F auid>=1000 -F auid!=-1 -S execve -k privesc_root_cmd
-a always,exit -F arch=b64 -F euid=0 -S execve -k privesc_root_cmd

## ============================================================
## Command Execution
## General command execution monitoring
## ============================================================

-a always,exit -F arch=b32 -S execve -F auid=1000 -F egid!=994 -F auid!=-1 -k audit_wazuh_c
-a always,exit -F arch=b32 -S execve -F path=/bin/chmod -k defense_impair_perms
-a always,exit -F arch=b64 -S execve -F auid=1000 -F egid!=994 -F auid!=-1 -k audit_wazuh_c
-a always,exit -F arch=b64 -S execve -F path=/bin/bash -k exec_shell

## ============================================================
## Permission Changes
## File permission and ownership modifications
## ============================================================

-a always,exit -F arch=b32 -S chmod -F auid>=1000 -F auid!=-1 -k defense_perm_mod
-a always,exit -F arch=b32 -S chmod,fchmod,fchmodat -F auid>=1000 -F auid!=-1 -k defense_perm_mod
-a always,exit -F arch=b32 -S chown -F auid>=1000 -F auid!=-1 -k defense_perm_mod
-a always,exit -F arch=b32 -S chown,fchown,fchownat,lchown -F auid>=1000 -F auid!=-1 -k defense_perm_mod
-a always,exit -F arch=b32 -S fchmod -F auid>=1000 -F auid!=-1 -k defense_perm_mod
-a always,exit -F arch=b32 -S fchmodat -F auid>=1000 -F auid!=-1 -k defense_perm_mod
-a always,exit -F arch=b32 -S fchmodat -F auid>=1000 -F auid!=-1 -k defense_perm_mod
-a always,exit -F arch=b32 -S fchown -F auid>=1000 -F auid!=-1 -k defense_perm_mod
-a always,exit -F arch=b32 -S fchownat -F auid>=1000 -F auid!=-1 -k defense_perm_mod
-a always,exit -F arch=b32 -S lchown -F auid>=1000 -F auid!=-1 -k defense_perm_mod
-a always,exit -F arch=b32 -S removexattr -F auid>=1000 -F auid!=-1 -k defense_perm_mod
-a always,exit -F arch=b32 -S rename -S renameat -S truncate -S chmod -S setxattr -S lsetxattr -S removexattr -S lremovexattr -F exit=-EACCES -k file_modify
-a always,exit -F arch=b32 -S setxattr -F auid>=1000 -F auid!=-1 -k defense_perm_mod
-a always,exit -F arch=b32 -S setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F auid>=1000 -F auid!=-1 -k defense_perm_mod
-a always,exit -F arch=b64 -S chmod -F auid>=1000 -F auid!=-1 -k defense_perm_mod
-a always,exit -F arch=b64 -S chmod -F auid>=1000 -F perm=x -k privesc
-a always,exit -F arch=b64 -S chmod,fchmod,fchmodat -F auid>=1000 -F auid!=-1 -k defense_perm_mod
-a always,exit -F arch=b64 -S chown -F auid>=1000 -F auid!=-1 -k defense_perm_mod
-a always,exit -F arch=b64 -S chown,fchown,fchownat,lchown -F auid>=1000 -F auid!=-1 -k defense_perm_mod
-a always,exit -F arch=b64 -S fchmod -F auid>=1000 -F auid!=-1 -k defense_perm_mod
-a always,exit -F arch=b64 -S fchmod -F auid>=1000 -F perm=x -k privesc
-a always,exit -F arch=b64 -S fchmodat -F auid>=1000 -F auid!=-1 -k defense_perm_mod
-a always,exit -F arch=b64 -S fchmodat -F auid>=1000 -F perm=x -k privesc
-a always,exit -F arch=b64 -S fchown -F auid>=1000 -F auid!=-1 -k defense_perm_mod
-a always,exit -F arch=b64 -S fchownat -F auid>=1000 -F auid!=-1 -k defense_perm_mod
-a always,exit -F arch=b64 -S lchown -F auid>=1000 -F auid!=-1 -k defense_perm_mod
-a always,exit -F arch=b64 -S removexattr -F auid>=1000 -F auid!=-1 -k defense_perm_mod
-a always,exit -F arch=b64 -S removexattr -F auid>=1000 -F auid!=-1 -k defense_perm_mod
-a always,exit -F arch=b64 -S removexattr -F auid>=1000 -k privesc
-a always,exit -F arch=b64 -S rename -S renameat -S truncate -S chmod -S setxattr -S lsetxattr -S removexattr -S lremovexattr -F exit=-EACCES -k cred_file_mod
-a always,exit -F arch=b64 -S setxattr -F auid>=1000 -F auid!=-1 -k defense_perm_mod
-a always,exit -F arch=b64 -S setxattr -F auid>=1000 -k privesc
-a always,exit -F arch=b64 -S setxattr,lsetxattr,fsetxattr,removexattr,lremovexattr,fremovexattr -F auid>=1000 -F auid!=-1 -k defense_perm_mod

## ============================================================
## Kernel Modules
## Loading/unloading kernel modules (rootkit detection)
## ============================================================

-a always,exit -F arch=b32 -S delete_module -k kernel_module_unload
-a always,exit -F arch=b32 -S finit_module -S init_module -S delete_module -F auid!=-1 -k kernel_module
-a always,exit -F arch=b32 -S init_module,finit_module -k kernel_module_load
-a always,exit -F arch=b64 -S delete_module -k kernel_module_unload
-a always,exit -F arch=b64 -S finit_module -S init_module -S delete_module -F auid!=-1 -k kernel_module
-a always,exit -F arch=b64 -S init_module -S delete_module -k kernel_module
-a always,exit -F arch=b64 -S init_module,finit_module -k kernel_module_load
-a always,exit -F arch=b64 -S kexec_load -k kernel_kexec

## ============================================================
## Network Syscalls
## Socket creation, connections, and hostname changes
## ============================================================

-a always,exit -F arch=ARCH -S sethostname -S setdomainname -k net_config
-a always,exit -F arch=b32 -S connect -F a2=16 -F success=1 -k net_connect
-a always,exit -F arch=b32 -S sethostname -S setdomainname -k net_config
-a always,exit -F arch=b32 -S socket -F a0=10 -F euid=33 -k ccdc_web_socket
-a always,exit -F arch=b32 -S socket -F a0=10 -F euid=<USER_ID> -k webshell_net
-a always,exit -F arch=b32 -S socket -F a0=10 -k net_socket
-a always,exit -F arch=b64 -S connect -F a2=16 -F success=1 -k net_connect
-a always,exit -F arch=b64 -S listen -F success=1 -k net_listener
-a always,exit -F arch=b64 -S sethostname -S setdomainname -k net_config
-a always,exit -F arch=b64 -S socket -F a0=10 -F euid=33 -k ccdc_web_socket
-a always,exit -F arch=b64 -S socket -F a0=10 -F euid=<USER_ID> -k webshell_net
-a always,exit -F arch=b64 -S socket -F a0=10 -k net_socket
-a always,exit -F arch=b64 -S socket -S bind -S connect -F auid>=1000 -k net_sniff

## ============================================================
## Process Injection
## ptrace and memory manipulation (code injection)
## ============================================================

-a always,exit -F arch=b32 -S ptrace -F a0=0x6 -k inject_register
-a always,exit -F arch=b64 -S ptrace -F a0=0x4 -k inject_process

## ============================================================
## Mount Operations
## Filesystem mounts and swap (data exfil, persistence)
## ============================================================

-a always,exit -F arch=ARCH -S mount -F auid>=1000 -F auid!=-1 -k mount_export
-a always,exit -F arch=b32 -S mount -F auid>=1000 -F auid!=-1 -k mount
-a always,exit -F arch=b32 -S mount -S umount -S umount2 -F auid!=-1 -k mount
-a always,exit -F arch=b32 -S swapon -S swapoff -F auid!=-1 -k mount_swap
-a always,exit -F arch=b64 -S mount -F auid>=1000 -F auid!=-1 -k mount
-a always,exit -F arch=b64 -S mount -S umount2 -F auid!=-1 -k mount
-a always,exit -F arch=b64 -S swapon -S swapoff -F auid!=-1 -k mount_swap

## ============================================================
## Time Modification
## System time changes (anti-forensics)
## ============================================================

-a always,exit -F arch=b32 -F uid!=ntp -S adjtimex -S settimeofday -S clock_settime -k time_change
-a always,exit -F arch=b32 -S adjtimex,settimeofday,stime -k time_change
-a always,exit -F arch=b32 -S clock_settime -F a0=0x0 -k time_change
-a always,exit -F arch=b64 -F uid!=ntp -S adjtimex -S settimeofday -S clock_settime -k time_change
-a always,exit -F arch=b64 -S adjtimex -k time_change
-a always,exit -F arch=b64 -S adjtimex,settimeofday -k time_change
-a always,exit -F arch=b64 -S clock_settime -k time_change
-a always,exit -F arch=b64 -S settimeofday -k time_change

## ============================================================
## Container Operations
## Namespace and container creation
## ============================================================

-a always,exit -F arch=b32 -S clone -F a0&0x7C020000 -k container_create
-a always,exit -F arch=b32 -S unshare,setns -k container_config
-a always,exit -F arch=b64 -S clone -F a0&0x7C020000 -k container_create
-a always,exit -F arch=b64 -S unshare,setns -k container_config

## ============================================================
## File Operations
## File creation, deletion, and modification
## ============================================================

-a always,exit -F arch=ARCH -S rmdir -S unlink -S unlinkat -S rename -S renameat -F auid>=1000 -F auid!=-1 -k defense_file_delete
-a always,exit -F arch=b32 -S creat -S open -S openat -S open_by_handle_at -S truncate -S ftruncate -F exit=-EACCES -F auid>=1000 -F auid!=-1 -k file_access
-a always,exit -F arch=b32 -S creat -S open,openat,truncate,ftruncate -F exit=-EACCES -F auid>=1000 -F auid!=-1 -k file_access
-a always,exit -F arch=b32 -S creat,link,mknod,mkdir,symlink,mknodat,linkat,symlinkat -F exit=-EACCES -k file_create
-a always,exit -F arch=b32 -S link,mkdir,symlink,mkdirat -F exit=-EPERM -k file_create
-a always,exit -F arch=b32 -S mknod -S mknodat -k special_files
-a always,exit -F arch=b32 -S open,openat,openat2,open_by_handle_at -F exit=-EPERM -k file_open_fail
-a always,exit -F arch=b32 -S rmdir -S unlink -S unlinkat -S rename -S renameat -F auid>=1000 -F auid!=-1 -k defense_file_delete
-a always,exit -F arch=b32 -S unlink,rmdir,unlinkat -F exit=-EPERM -k file_delete_fail
-a always,exit -F arch=b32 -S unlink,unlinkat,rename,renameat -F auid>=1000 -F auid!=-1 -k defense_file_delete
-a always,exit -F arch=b64 -S creat -S open -S openat -S open_by_handle_at -S truncate -S ftruncate -F exit=-EACCES -F auid>=1000 -F auid!=-1 -k cred_file_access
-a always,exit -F arch=b64 -S creat -S open,openat,truncate,ftruncate -F exit=-EPERM -F auid>=1000 -F auid!=-1 -k file_access
-a always,exit -F arch=b64 -S mkdir -F dir=/root/.ssh -F success=1 -k hidden_files
-a always,exit -F arch=b64 -S mkdir,creat,link,symlink,mknod,mknodat,linkat,symlinkat -F exit=-EACCES -k cred_file_create
-a always,exit -F arch=b64 -S mkdir,link,symlink,mkdirat -F exit=-EPERM -k cred_file_create
-a always,exit -F arch=b64 -S mknod -S mknodat -k special_files
-a always,exit -F arch=b64 -S open -F dir=/bin -F success=0 -k unauthedfileaccess
-a always,exit -F arch=b64 -S open,openat,openat2,open_by_handle_at -F exit=-EPERM -k file_open_fail
-a always,exit -F arch=b64 -S openat -F dir=/lib64 -F perm=x -k defense_hijack_exec
-a always,exit -F arch=b64 -S rmdir -S unlink -S unlinkat -S rename -S renameat -F auid!=-1 -k defense_file_delete
-a always,exit -F arch=b64 -S rmdir -S unlink -S unlinkat -S rename -S renameat -F auid>=1000 -F auid!=-1 -k defense_file_delete
-a always,exit -F arch=b64 -S rmdir,unlink,unlinkat -F exit=-EPERM -k file_delete_fail
-a always,exit -F arch=b64 -S unlink -S unlinkat -S rename -S renameat -F auid>=1000 -F exit=-EACCES -k file_delete
-a always,exit -F arch=b64 -S unlink,unlinkat,rename,renameat -F auid>=1000 -F auid!=-1 -k defense_file_delete

## ============================================================
## System Impact
## Shutdown, reboot, service termination
## ============================================================

-a always,exit -F arch=b32 -S reboot -k impact_shutdown
-a always,exit -F arch=b64 -S kill -F a1=9 -k impact_service_stop
-a always,exit -F arch=b64 -S reboot -S shutdown -k impact_shutdown
-a always,exit -F arch=b64 -S reboot -k impact_shutdown

## ============================================================
## Anonymous Files
## In-memory file creation (fileless malware)
## ============================================================

-a always,exit -F arch=b32 -S memfd_create -k exfil_anon_file
-a always,exit -F arch=b64 -S memfd_create -k exfil_anon_file

## ============================================================
## Inter-Process Communication
## Shared memory and semaphores
## ============================================================

-a always,exit -F arch=b64 -S msgctl -k ipc
-a always,exit -F arch=b64 -S msgget -k ipc
-a always,exit -F arch=b64 -S semctl -k ipc
-a always,exit -F arch=b64 -S semget -k ipc
-a always,exit -F arch=b64 -S semop -k ipc
-a always,exit -F arch=b64 -S shmctl -k ipc
-a always,exit -F arch=b64 -S shmget -k ipc

## ============================================================
## Other Syscalls
## Miscellaneous syscall monitoring
## ============================================================

-a always,exit -F arch=b32 -F path=/usr/bin/gzexe -F perm=x -k exfil_compress
-a always,exit -F arch=b32 -F path=/usr/sbin/gzexe -F perm=x -k exfil_compress
-a always,exit -F arch=b32 -S all -k 32bit_api
-a always,exit -F arch=b32 -S fremovexattr -F auid>=1000 -F auid!=-1 -k defense_perm_mod
-a always,exit -F arch=b32 -S fsetxattr -F auid>=1000 -F auid!=-1 -k defense_perm_mod
-a always,exit -F arch=b32 -S lremovexattr -F auid>=1000 -F auid!=-1 -k defense_perm_mod
-a always,exit -F arch=b32 -S lsetxattr -F auid>=1000 -F auid!=-1 -k defense_perm_mod
-a always,exit -F arch=b32 -S sys_kexec_load -k kernel_kexec
-a always,exit -F arch=b64 -S fremovexattr -F auid>=1000 -F auid!=-1 -k defense_perm_mod
-a always,exit -F arch=b64 -S fsetxattr -F auid>=1000 -F auid!=-1 -k defense_perm_mod
-a always,exit -F arch=b64 -S lremovexattr -F auid>=1000 -F auid!=-1 -k defense_perm_mod
-a always,exit -F arch=b64 -S lsetxattr -F auid>=1000 -F auid!=-1 -k defense_perm_mod
-a always,exit -F arch=b64 -S semtimedop -k ipc
-a always,exit -F arch=b64 -S utime -S utimensat -k defense_timestomp
-a always,exit -F dir=/dev/shm -F perm=x -k defense_masquerade
-a always,exit -F dir=/etc/NetworkManager/ -F perm=wa -k net_config
-a always,exit -F dir=/home -F auid=0 -F auid>=1000 -F auid!=-1 -C auid!=obj_uid -k privesc_abuse
-a always,exit -F dir=/home -F uid=0 -F auid>=1000 -F auid!=-1 -C auid!=obj_uid -k privesc_abuse
-a always,exit -F path=/lib64/dbus-1/dbus-daemon-launch-helper -F perm=x -F auid>=1000 -F auid!=-1 -k persist_accounts
-a always,exit -F path=/lib64/vte-2.91/gnome-pty-helper -F perm=x -F auid>=1000 -F auid!=-1 -k persist_accounts
-a always,exit -F path=/sbin/mount.nfs -F perm=x -F auid>=1000 -F auid!=-1 -k persist_accounts
-a always,exit -F path=/usr/bin/setfiles -F perm=x -F auid>=1000 -F auid!=-1 -k _f T1078_Valid_Accounts
-a always,exit -F path=/usr/lib64/dbus-1/dbus-daemon-launch-helper -F perm=x -F auid>=1000 -F auid!=-1 -k persist_accounts
-a always,exit -F path=/usr/lib64/vte-2.91/gnome-pty-helper -F perm=x -F auid>=1000 -F auid!=-1 -k persist_accounts
-a always,exit -F path=/usr/libexec/kde4/kdesud -F perm=x -F auid>=1000 -F auid!=-1 -k persist_accounts
-a always,exit -F path=/usr/libexec/kde4/kpac_dhcp_helper -F perm=x -F auid>=1000 -F auid!=-1 -k persist_accounts
-a always,exit -F path=/usr/libexec/sssd/krb5_child -F perm=x -F auid>=1000 -F auid!=-1 -k persist_accounts
-a always,exit -F path=/usr/libexec/sssd/ldap_child -F perm=x -F auid>=1000 -F auid!=-1 -k persist_accounts
-a always,exit -F path=/usr/libexec/sssd/p11_child -F perm=x -F auid>=1000 -F auid!=-1 -k persist_accounts
-a always,exit -F path=/usr/libexec/sssd/proxy_child -F perm=x -F auid>=1000 -F auid!=-1 -k persist_accounts
-a always,exit -F path=/usr/libexec/sssd/selinux_child -F perm=x -F auid>=1000 -F auid!=-1 -k persist_accounts
-a always,exit -F path=/usr/sbin/aulast -F perm=x -k t1005_data_from_local_system_audit_log
-a always,exit -F path=/usr/sbin/aulastlogin -F perm=x -k t1005_data_from_local_system_audit_log
-a always,exit -F path=/usr/sbin/aureport -F perm=x -k t1005_data_from_local_system_audit_log
-a always,exit -F path=/usr/sbin/ausearch -F perm=x -k t1005_data_from_local_system_audit_log
-a always,exit -F path=/usr/sbin/auvirt -F perm=x -k t1005_data_from_local_system_audit_log
-a always,exit -F path=/usr/sbin/mount.nfs -F perm=x -F auid>=1000 -F auid!=-1 -k persist_accounts
-a always,exit -F path=/usr/sbin/setfiles -F perm=x -F auid>=1000 -F auid!=-1 -k _f T1078_Valid_Accounts
-a always,exit -F perm=x -F auid!=-1 -F path=/sbin/insmod -k kernel_module
-a always,exit -F perm=x -F auid!=-1 -F path=/sbin/modprobe -k kernel_module
-a always,exit -F perm=x -F auid!=-1 -F path=/sbin/rmmod -k kernel_module

## ============================================================
## Audit Configuration Watches
## Protect audit system from tampering
## ============================================================

-w /etc/audisp/ -p wa -k audit_config
-w /etc/audit/ -p wa -k audit_config
-w /etc/audit/audit.rules -p wa -k audit_config
-w /etc/audit/auditd.conf -p wa -k defense_impair_audit
-w /etc/audit/rules.d/ -p wa -k defense_impair_audit
-w /etc/libaudit.conf -p wa -k audit_config
-w /sbin/auditctl -p x -k audit_tools
-w /sbin/auditd -p x -k audit_tools
-w /usr/sbin/auditd -p x -k audit_tools
-w /usr/sbin/augenrules -p x -k audit_tools
-w /var/audit/ -p wra -k t1005_data_from_local_system_audit_log
-w /var/log/audit/ -p wra -k t1005_data_from_local_system_audit_log

## ============================================================
## Persistence Watches
## Cron, systemd, init scripts - common persistence locations
## ============================================================

-w /etc/cron.allow -p wa -k persist_modify
-w /etc/cron.d -p wa -k persist_modify
-w /etc/cron.d/ -p wa -k persist_sched_task
-w /etc/cron.daily -p wa -k persist_modify
-w /etc/cron.daily/ -p wa -k persist_sched_task
-w /etc/cron.deny -p wa -k persist_modify
-w /etc/cron.hourly -p wa -k persist_modify
-w /etc/cron.hourly/ -p wa -k persist_sched_task
-w /etc/cron.monthly -p wa -k persist_modify
-w /etc/cron.monthly/ -p wa -k persist_sched_task
-w /etc/cron.weekly -p wa -k persist_modify
-w /etc/cron.weekly/ -p wa -k persist_sched_task
-w /etc/crontab -p wa -k persist_sched_task
-w /var/spool/at -p wa -k persist_modify
-w /var/spool/at/spool -p wa -k persist_modify
-w /var/spool/atspool -k persist_sched_task
-w /var/spool/cron -p wa -k persist_modify
-w /var/spool/cron/ -p wa -k persist_sched_task
-w /var/spool/cron/atjobs -p wa -k persist_modify
-w /var/spool/cron/atspool -p wa -k persist_modify
-w /var/spool/cron/root -k persist_sched_task
-w /bin/systemctl -p x -k systemd
-w /etc/systemd -p wa -k persist_modify
-w /etc/systemd/ -p w -k ccdc_systemd
-w /etc/systemd/logind.conf -p wa -k powersettings
-w /etc/systemd/sleep.conf -p wa -k powersettings
-w /etc/systemd/system-generators/ -p wa -k systemd_gen
-w /etc/systemd/system/ -p wa -k persist_sched_task
-w /etc/systemd/user-generators/ -p wa -k systemd_gen
-w /lib/systemd -p wa -k persist_modify
-w /lib/systemd/system-generators/ -p wa -k systemd_gen
-w /lib/systemd/system/ -p wa -k service_mod
-w /lib/systemd/system/atftpd.service -k c2_susp_tools
-w /lib/systemd/system/atftpd.socket -k c2_susp_tools
-w /lib/systemd/system/uftp.service -k c2_susp_tools
-w /usr/lib/systemd -p wa -k persist_modify
-w /usr/lib/systemd/system-generators -p wa -k systemd_gen
-w /usr/lib/systemd/system/ -p wa -k persist_sched_task
-w /usr/lib/systemd/system/atftpd.service -k c2_susp_tools
-w /usr/lib/systemd/system/atftpd.socket -k c2_susp_tools
-w /usr/lib/systemd/system/docker.service -k container_docker
-w /usr/lib/systemd/system/docker.socket -k container_docker
-w /usr/lib/systemd/system/uftp.service -k c2_susp_tools
-w /usr/local/lib/systemd/system-generators/ -p wa -k systemd_gen
-w /usr/local/lib/systemd/user-generators/ -p wa -k systemd_gen
-w /etc/init -p wa -k persist_modify
-w /etc/init.d -p wa -k persist_modify
-w /etc/init.d/ -p wa -k persist_boot
-w /etc/init/ -p w -k ccdc_initd
-w /etc/inittab -p wa -k persist_modify
-w /etc/profile -p wa -k persist_boot
-w /etc/profile.d/ -p wa -k persist_boot
-w /etc/rc.boot -p wa -k persist_modify
-w /etc/rc.d -p wa -k persist_modify
-w /etc/rc.d/ -p wa -k persist_boot
-w /etc/rc.local -p wa -k persist_boot

## ============================================================
## Account File Watches
## passwd, shadow, group - account manipulation
## ============================================================

-w /etc/group -p wa -k persist_accounts
-w /etc/gshadow -p wa -k persist_accounts
-w /etc/passwd -p wa -k persist_accounts
-w /etc/shadow -p wa -k persist_accounts

## ============================================================
## Authentication Watches
## sudoers, PAM, security configs
## ============================================================

-w /etc/pam.d/ -p wa -k cred_auth_mod
-w /etc/security/ -p wa -k cred_auth_mod
-w /etc/security/limits.conf -p wa -k cred_pam
-w /etc/security/limits.d -p wa -k cred_pam
-w /etc/security/namespace.conf -p wa -k cred_pam
-w /etc/security/namespace.d -p wa -k cred_pam
-w /etc/security/namespace.init -p wa -k cred_pam
-w /etc/security/opasswd -p wa -k persist_accounts
-w /etc/security/pam_env.conf -p wa -k cred_pam
-w /etc/security/pwquality.conf -p r -k discover_passwd_policy
-w /etc/sudoers -p wa -k privesc_sudoers
-w /etc/sudoers.d -p rw -k privesc
-w /etc/sudoers.d/ -p wa -k privesc_sudoers

## ============================================================
## SSH Configuration Watches
## SSH server and client configuration
## ============================================================

-w /etc/ssh/ -p w -k ccdc_ssh
-w /etc/ssh/sshd_config -p wa -k c2_remote_svc
-w /etc/ssh/sshd_config.d -k ssh_config

## ============================================================
## Firewall Configuration Watches
## iptables, firewalld, nftables, ufw configs
## ============================================================

-w /etc/firewalld/ -p wa -k defense_impair_fw
-w /etc/iptables/ -p wa -k defense_impair_fw
-w /etc/nftables.conf -p wa -k defense_impair_fw
-w /etc/ufw/ -p wa -k defense_impair_fw
-w /sbin/iptables -p x -k defense_fw_tools
-w /usr/sbin/ufw -p x -k defense_fw_tools

## ============================================================
## Network Configuration Watches
## DNS, routing, interface configs
## ============================================================

-w /etc/hosts -p wa -k c2_dns_mod
-w /etc/network -p wa -k system_locale
-w /etc/network/ -p wa -k net_config
-w /etc/network/interfaces -p wa -k net_config
-w /etc/nsswitch.conf -p wa -k c2_dns_mod
-w /etc/resolv.conf -p wa -k c2_dns

## ============================================================
## Shell Execution Watches
## Shell interpreters and terminal multiplexers
## ============================================================

-w /bin/ash -p x -k exec_shell
-w /bin/bash -p x -k exec_shell
-w /bin/busybox -p x -k exec_shell
-w /bin/clush -p x -k exec_shell
-w /bin/csh -p x -k exec_shell
-w /bin/dash -p x -k exec_shell
-w /bin/fish -p x -k exec_shell
-w /bin/ksh -p x -k exec_shell
-w /bin/open -p x -k exec_shell
-w /bin/rbash -p x -k exec_shell
-w /bin/sh -p x -k exec_shell
-w /bin/tclsh -p x -k exec_shell
-w /bin/tcsh -p x -k exec_shell
-w /bin/tmux -p x -k exec_shell
-w /bin/wish -p x -k exec_shell
-w /bin/xonsh -p x -k exec_shell
-w /bin/yash -p x -k exec_shell
-w /bin/zsh -p x -k exec_shell
-w /sbin/shutdown -p x -k impact_power
-w /usr/bin/rawshark -p x -k c2_susp_tools
-w /usr/bin/ssh -p x -k c2_susp_tools
-w /usr/bin/tshark -p x -k c2_susp_tools
-w /usr/bin/wireshark -p x -k c2_susp_tools
-w /usr/bin/wish -p x -k exec_shell
-w /usr/bin/yash -p x -k exec_shell
-w /usr/local/bin/clush -p x -k exec_shell
-w /usr/local/bin/tmux -p x -k exec_shell
-w /usr/local/bin/xonsh -p x -k exec_shell
-w /usr/local/bin/xxh.bash -p x -k exec_shell
-w /usr/local/bin/xxh.xsh -p x -k exec_shell
-w /usr/local/bin/xxh.zsh -p x -k exec_shell

## ============================================================
## Package Manager Watches
## apt, yum, dnf, rpm - software installation
## ============================================================

-w /bin/rpm -p x -k exec_pkg_mgr
-w /sbin/yast -p x -k exec_pkg_mgr
-w /sbin/yast2 -p x -k exec_pkg_mgr
-w /usr/bin/apt -p x -k exec_pkg_mgr
-w /usr/bin/apt-add-repository -p x -k exec_pkg_mgr
-w /usr/bin/apt-get -p x -k exec_pkg_mgr
-w /usr/bin/aptitude -p x -k exec_pkg_mgr
-w /usr/bin/cpan -p x -k exec_pkg_mgr
-w /usr/bin/dnf -p x -k exec_pkg_mgr
-w /usr/bin/dpkg -p x -k exec_pkg_mgr
-w /usr/bin/gem -p x -k exec_pkg_mgr
-w /usr/bin/luarocks -p x -k exec_pkg_mgr
-w /usr/bin/npm -p x -k exec_pkg_mgr
-w /usr/bin/pip -p x -k exec_pkg_mgr
-w /usr/bin/pip3 -p x -k exec_pkg_mgr
-w /usr/bin/pipx -p x -k exec_pkg_mgr
-w /usr/bin/rpm -p x -k exec_pkg_mgr
-w /usr/bin/snap -p x -k exec_pkg_mgr
-w /usr/bin/wajig -p x -k exec_pkg_mgr
-w /usr/bin/yum -p x -k exec_pkg_mgr
-w /usr/bin/zypper -k exec_pkg_mgr
-w /usr/local/bin/pip -p x -k exec_pkg_mgr
-w /usr/local/bin/pip3 -p x -k exec_pkg_mgr
-w /usr/local/bin/pipx -p x -k exec_pkg_mgr

## ============================================================
## C2 Tool Watches
## netcat, socat, curl, wget - data transfer tools
## ============================================================

-w /bin/nc -p x -k c2_tools
-w /bin/netcat -p x -k c2_tools
-w /usr/bin/nc -p x -k ccdc_netcat
-w /usr/bin/ncat -p x -k c2_tools
-w /usr/bin/socat -p x -k c2_susp_tools

## ============================================================
## Compression Tool Watches
## Data compression before exfiltration
## ============================================================

-w /usr/bin/bzip2 -p x -k exfil_compress
-w /usr/bin/gzip -p x -k exfil_compress
-w /usr/bin/lbzip2 -p x -k exfil_compress
-w /usr/bin/lz4 -p x -k exfil_compress
-w /usr/bin/lzip -p x -k exfil_compress
-w /usr/bin/lzop -p x -k exfil_compress
-w /usr/bin/pbzip2 -p x -k exfil_compress
-w /usr/bin/pigz -p x -k exfil_compress
-w /usr/bin/pixz -p x -k exfil_compress
-w /usr/bin/plzip -p x -k exfil_compress
-w /usr/bin/tar -p x -k exfil_compress
-w /usr/bin/unpigz -p x -k exfil_compress
-w /usr/bin/zip -p x -k exfil_compress
-w /usr/bin/zstd -p x -k exfil_compress
-w /usr/local/bin/VBoxAutostart -p x -k virt_detect
-w /usr/local/bin/lbzip2 -p x -k exfil_compress
-w /usr/local/bin/lz4 -p x -k exfil_compress
-w /usr/local/bin/lzip -p x -k exfil_compress
-w /usr/local/bin/lzop -p x -k exfil_compress
-w /usr/local/bin/pbzip2 -p x -k exfil_compress
-w /usr/local/bin/pigz -p x -k exfil_compress
-w /usr/local/bin/pixz -p x -k exfil_compress
-w /usr/local/bin/plzip -p x -k exfil_compress
-w /usr/local/bin/unpigz -p x -k exfil_compress
-w /usr/local/bin/zstd -p x -k exfil_compress

## ============================================================
## Binary Directory Watches
## Modifications to system binary directories
## ============================================================

-w /bin/ -p wa -k defense_masquerade
-w /bin/hostname -p x -k recon
-w /bin/nc.openbsd -p x -k c2_susp_tools
-w /bin/nc.traditional -p x -k c2_susp_tools
-w /bin/rm -p x -k monitor_rm
-w /bin/su -p x -k privesc
-w /bin/uname -p x -k recon
-w /sbin/ -p wa -k defense_masquerade
-w /sbin/debugfs -p x -k timestompdebugfs
-w /sbin/halt -p x -k impact_power
-w /sbin/ifconfig -p x -k defense_fw_tools
-w /sbin/ip6tables -p x -k defense_fw_tools
-w /sbin/poweroff -p x -k impact_power
-w /sbin/reboot -p x -k impact_power
-w /sbin/xtables-nft-multi -p x -k defense_fw_tools
-w /usr/bin -p wa -k persist_modify
-w /usr/bin/ -p wa -k defense_masquerade
-w /usr/bin/VBoxManage -p x -k virt_vbox
-w /usr/bin/ack -p x -k recon_search
-w /usr/bin/ag -p x -k recon_search
-w /usr/bin/atftpd -p x -k c2_susp_tools
-w /usr/bin/base64 -p x -k c2_susp_tools
-w /usr/bin/bgrep -p x -k recon_search
-w /usr/bin/cgrep -p x -k recon_search
-w /usr/bin/clang -p x -k compile_after_delivery
-w /usr/bin/curl -p x -k c2_susp_tools
-w /usr/bin/dbus-send -p x -k dbus_send
-w /usr/bin/docker -k container_docker
-w /usr/bin/docker-containerd -k container_docker
-w /usr/bin/docker-runc -k container_docker
-w /usr/bin/dockerd -k container_docker
-w /usr/bin/egrep -p x -k recon_search
-w /usr/bin/ftp -p x -k c2_susp_tools
-w /usr/bin/gcc -p x -k compile_after_delivery
-w /usr/bin/gdbus -p x -k gdubs_call
-w /usr/bin/grep -p x -k recon_search
-w /usr/bin/id -p x -k recon
-w /usr/bin/in.tftpd -p x -k c2_susp_tools
-w /usr/bin/kubelet -k container_k8s
-w /usr/bin/make -p x -k compile_after_delivery
-w /usr/bin/netstat -p x -k c2_susp_tools
-w /usr/bin/ngrep -p x -k recon_search
-w /usr/bin/nmap -p x -k c2_susp_tools
-w /usr/bin/passwd -p x -k ccdc_passwd
-w /usr/bin/pkexec -p x -k pkexec
-w /usr/bin/pt -p x -k recon_search
-w /usr/bin/qemu -p x -k virt_qemu
-w /usr/bin/qemu-img -p x -k virt_qemu
-w /usr/bin/qemu-system-x86_64 -p x -k virt_qemu
-w /usr/bin/rdesktop -p x -k c2_susp_tools
-w /usr/bin/rg -p x -k recon_search
-w /usr/bin/scp -p x -k c2_susp_tools
-w /usr/bin/semgrep -p x -k recon_search
-w /usr/bin/sftp -p x -k c2_susp_tools
-w /usr/bin/ss -p x -k c2_susp_tools
-w /usr/bin/stunnel -p x -k stunnel
-w /usr/bin/su -p wa -k privesc_su
-w /usr/bin/sudo -p x -k privesc
-w /usr/bin/ucg -p x -k recon_search
-w /usr/bin/uftp -p x -k c2_susp_tools
-w /usr/bin/ugrep -p x -k recon_search
-w /usr/bin/vgrep -p x -k recon_search
-w /usr/bin/virt-manager -p x -k virt_mgr
-w /usr/bin/virtualbox -p x -k virt_vbox
-w /usr/bin/wget -p x -k c2_susp_tools
-w /usr/bin/whoami -p x -k ccdc_whoami
-w /usr/bin/wlfreerdp -p x -k c2_susp_tools
-w /usr/bin/xfreerdp -p x -k c2_susp_tools
-w /usr/local/bin -p wa -k persist_modify
-w /usr/local/bin/VBoxBalloonCtrl -p x -k virt_detect
-w /usr/local/bin/VBoxBugReport -p x -k virt_detect
-w /usr/local/bin/VBoxDTrace -p x -k virt_detect
-w /usr/local/bin/VBoxHeadless -p x -k virt_detect
-w /usr/local/bin/VBoxManage -p x -k virt_detect
-w /usr/local/bin/VBoxVRDP -p x -k virt_detect
-w /usr/local/bin/VirtualBox -p x -k virt_detect
-w /usr/local/bin/VirtualBoxVM -p x -k virt_detect
-w /usr/local/bin/ack -p x -k recon_search
-w /usr/local/bin/ag -p x -k recon_search
-w /usr/local/bin/bgrep -p x -k recon_search
-w /usr/local/bin/cgrep -p x -k recon_search
-w /usr/local/bin/egrep -p x -k recon_search
-w /usr/local/bin/grep -p x -k recon_search
-w /usr/local/bin/ngrep -p x -k recon_search
-w /usr/local/bin/prl_convert -p x -k virt_detect
-w /usr/local/bin/prl_disk_tool -p x -k virt_detect
-w /usr/local/bin/prl_perf_ctl -p x -k virt_detect
-w /usr/local/bin/prlcore2dmp -p x -k virt_detect
-w /usr/local/bin/prlctl -p x -k virt_detect
-w /usr/local/bin/prlexec -p x -k virt_detect
-w /usr/local/bin/prlsrvctl -p x -k virt_detect
-w /usr/local/bin/pt -p x -k recon_search
-w /usr/local/bin/qemu-edid -p x -k virt_detect
-w /usr/local/bin/qemu-img -p x -k virt_detect
-w /usr/local/bin/qemu-io -p x -k virt_detect
-w /usr/local/bin/qemu-nbd -p x -k virt_detect
-w /usr/local/bin/qemu-system-x86_64 -p x -k virt_detect
-w /usr/local/bin/rdesktop -p x -k c2_susp_tools
-w /usr/local/bin/rg -p x -k recon_search
-w /usr/local/bin/semgrep -p x -k recon_search
-w /usr/local/bin/ucg -p x -k recon_search
-w /usr/local/bin/ugrep -p x -k recon_search
-w /usr/local/bin/vbox-img -p x -k virt_detect
-w /usr/local/bin/vboxwebsrv -p x -k virt_detect
-w /usr/local/bin/vgrep -p x -k recon_search
-w /usr/local/bin/xfreerdp -p x -k c2_susp_tools
-w /usr/sbin -p wa -k persist_modify
-w /usr/sbin/ -p wa -k defense_masquerade
-w /usr/sbin/addgroup -p x -k persist_accounts
-w /usr/sbin/adduser -p x -k ccdc_adduser
-w /usr/sbin/arptables -p x -k defense_fw_tools
-w /usr/sbin/atftpd -p x -k c2_susp_tools
-w /usr/sbin/ebtables -p x -k defense_fw_tools
-w /usr/sbin/groupadd -p x -k persist_accounts
-w /usr/sbin/groupmod -p x -k persist_accounts
-w /usr/sbin/in.tftpd -p x -k c2_susp_tools
-w /usr/sbin/nft -p x -k defense_fw_tools
-w /usr/sbin/stunnel -p x -k stunnel
-w /usr/sbin/tcpdump -p x -k c2_susp_tools
-w /usr/sbin/traceroute -p x -k c2_susp_tools
-w /usr/sbin/uftp -p x -k c2_susp_tools
-w /usr/sbin/useradd -p x -k ccdc_useradd
-w /usr/sbin/userdel -p x -k persist_accounts
-w /usr/sbin/usermod -p x -k persist_accounts

## ============================================================
## Log File Watches
## Detect log tampering and clearing
## ============================================================

-w /var/log/auth.log -p wa -k defense_clear_logs
-w /var/log/btmp -p wa -k defense_clear_logs
-w /var/log/faillog -p wa -k cred_auth_mod
-w /var/log/lastlog -p wa -k cred_auth_mod
-w /var/log/messages -p wa -k defense_clear_logs
-w /var/log/syslog -p wa -k defense_clear_logs
-w /var/log/tallylog -p wa -k cred_auth_mod
-w /var/log/wtmp -p wa -k defense_clear_logs

## ============================================================
## Web Directory Watches
## Webshell deployment detection
## ============================================================

-w /etc/httpd/ -p wa -k persist_webshell
-w /var/www/ -p w -k ccdc_web
-w /var/www/html/ -p wa -k persist_webshell

## ============================================================
## Container Watches
## Docker, Kubernetes, container configs
## ============================================================

-w /etc/containers/ -p wa -k container_config
-w /etc/docker -k container_docker
-w /etc/docker/ -p wa -k container_config
-w /etc/sysconfig/docker -k container_docker
-w /etc/sysconfig/docker-storage -k container_docker
-w /var/lib/containers/ -p wa -k container_image
-w /var/lib/docker -k container_docker

## ============================================================
## Config File Watches
## General /etc configuration monitoring
## ============================================================

-w /etc/ -p wa -k config_mod
-w /etc/DIR_COLORS -p wa -k persist_modify
-w /etc/DIR_COLORS.lightbgcolor -p wa -k persist_modify
-w /etc/NetworkManager/system-connections/ -p wa -k impact_service_cfg
-w /etc/aliases -p wa -k mail
-w /etc/anacrontab -p wa -k persist_modify
-w /etc/ansible/ -p wa -k exec_config_mgmt
-w /etc/apt/sources.list -p wa -k exec_pkg_mgr
-w /etc/apt/sources.list.d/ -p wa -k exec_pkg_mgr
-w /etc/at.allow -p wa -k persist_modify
-w /etc/at.deny -p wa -k persist_modify
-w /etc/bash.bash_logout -p wa -k persist_modify
-w /etc/bash.bashrc -p wa -k persist_event_trigger
-w /etc/bash_completion -p wa -k persist_modify
-w /etc/bash_completion.d -p wa -k persist_modify
-w /etc/bashrc -p w -k ccdc_bashrc
-w /etc/chef -p wa -k persist_modify
-w /etc/chef/ -p wa -k exec_config_mgmt
-w /etc/clustershell/clush.conf -p x -k exec_shell
-w /etc/csh.cshrc -p wa -k shell_profiles
-w /etc/csh.login -p wa -k shell_profiles
-w /etc/default/cron -p wa -k persist_modify
-w /etc/default/knockd.conf -p wa -k c2_port_knock
-w /etc/dircolors -p wa -k persist_modify
-w /etc/environment -p wa -k defense_hijack_exec
-w /etc/exim4/ -p wa -k mail
-w /etc/fish -p wa -k persist_modify
-w /etc/fish/ -p wa -k shell_profiles
-w /etc/hostname -p r -k recon
-w /etc/incron.allow -p wa -k persist_modify
-w /etc/incron.conf -p wa -k persist_modify
-w /etc/incron.d -p wa -k persist_modify
-w /etc/incron.deny -p wa -k persist_modify
-w /etc/inetd.conf -p wa -k persist_modify
-w /etc/inetd.d -p wa -k persist_modify
-w /etc/issue -p wa -k net_config
-w /etc/issue.net -p wa -k net_config
-w /etc/knockd.conf -p wa -k c2_port_knock
-w /etc/ld.so.conf -p wa -k defense_hijack_exec
-w /etc/ld.so.conf.d -p wa -k persist_modify
-w /etc/ld.so.preload -p wa -k defense_hijack_exec
-w /etc/localtime -p wa -k time_change
-w /etc/login.defs -p r -k discover_passwd_policy
-w /etc/modprobe.conf -p wa -k kernel_module_cfg
-w /etc/modprobe.d -p wa -k kernel_module_cfg
-w /etc/netplan/ -p wa -k net_config
-w /etc/openvpn/ -p wa -k c2_remote_svc
-w /etc/otter -p wa -k persist_modify
-w /etc/pacman.conf -p x -k exec_pkg_mgr
-w /etc/pacman.d -p x -k exec_pkg_mgr
-w /etc/pki/ -p wa -k root_cert
-w /etc/postfix/ -p wa -k mail
-w /etc/profile.d -p wa -k persist_modify
-w /etc/protocols -p wa -k persist_modify
-w /etc/proxychains.conf -p wa -k c2_proxy
-w /etc/puppet -p wa -k persist_modify
-w /etc/puppet/ssl -p wa -k puppet_ssl
-w /etc/puppetlabs/ -p wa -k exec_config_mgmt
-w /etc/salt -p wa -k persist_modify
-w /etc/salt/ -p wa -k exec_config_mgmt
-w /etc/samba/smb.conf -p wa -k rogue_domain_controller
-w /etc/securetty -p wa -k cred_auth_mod
-w /etc/selinux/ -p wa -k selinux
-w /etc/services -p wa -k protocol_impersonation
-w /etc/shells -p wa -k shell_profiles
-w /etc/sysconfig/network -p wa -k net_config
-w /etc/sysconfig/network-scripts -p w -k net_config
-w /etc/sysctl.conf -p wa -k sysctl
-w /etc/sysctl.d -p wa -k sysctl
-w /etc/udev/rules.d/ -p wa -k persist_event_trigger
-w /etc/update-motd.d -p wa -k persist_modify
-w /etc/xinetd -p wa -k persist_modify
-w /etc/xinetd.conf -p wa -k persist_modify
-w /etc/yum.repos.d -p wa -k exec_pkg_mgr
-w /etc/zsh -p wa -k persist_modify
-w /etc/zsh/ -p wa -k shell_profiles
-w /usr/local/etc/salt -p wa -k persist_modify

## ============================================================
## Other File Watches
## Miscellaneous file monitoring
## ============================================================

-w /.config/ -p r -k discover_browser
-w /.mozilla/ -p r -k discover_browser
-w /Library/Application Support/VirtualBox/LaunchDaemons/ -p x -k virt_detect
-w /Library/LaunchDaemons/org.virtualbox.startup.plist -p x -k virt_detect
-w /Library/Preferences/Parallels -p x -k virt_detect
-w /bin -p wa -k persist_modify
-w /lib/modules -p wa -k kernel_module_cfg
-w /media/ -p wa -k exfil_usb
-w /mnt/ -p wa -k exfil_usb
-w /proc/self/maps -p wa -k inject_vdso
-w /proc/self/mem -p wa -k inject_vdso
-w /proc/sys/net/ipv4/icmp_echo_ignore_all -p wa -k icmp_break
-w /root/.bash_profile -p wa -k persist_shell_config
-w /root/.bashrc -p wa -k persist_shell_config
-w /root/.ssh -p wa -k ssh_config
-w /run/systemd -p wa -k persist_modify
-w /sbin -p wa -k persist_modify
-w /srv/salt/ -p wa -k exec_config_mgmt
-w /tmp -p wa -k defense_clear_logs
-w /tmp/ -p w -k ccdc_tmp
-w /usr/games -p wa -k persist_modify
-w /usr/local/games -p wa -k persist_modify
-w /usr/local/rc.boot -p wa -k persist_modify
-w /usr/local/rc.d -p wa -k persist_modify
-w /usr/local/rc.local -p wa -k persist_modify
-w /usr/local/sbin -p wa -k persist_modify
-w /usr/share/ca-certificates/ -p wa -k root_cert
-w /var/chef/ -p wa -k exec_config_mgmt
-w /var/lib/puppet/ -p wa -k exec_config_mgmt
-w /var/lib/samba/ -p wa -k rogue_domain_controller
-w /var/lib/terraform/ -p wa -k exec_config_mgmt
-w /var/opt/BESClient/ -p wa -k soft_besclient
-w /var/run/utmp -p wa -k auth_log
-w /var/spool/anacron -p wa -k persist_modify

## ============================================================
## Lock Configuration
## Make audit rules immutable (requires reboot to change)
## ============================================================

-e 2

## EOF
